(()=>{"use strict";var e,t={38:(e,t,l)=>{const n=Vue;var a={class:"w-full flex flex-row justify-between px-3 py-3"},i=(0,n.createElementVNode)("h1",{class:"text-center text-3xl text-gray-500 font-light"},"Метрики",-1),o=["disabled"],r={class:"w-full flex flex-wrap flex-row justify-center gap-6 px-3 py-3"},s={key:0,class:"flex flex-col justify-center"},u=(0,n.createElementVNode)("label",{for:"id",class:"font-semibold"},"Ідентифікатор закладу",-1),c={class:"flex flex-col justify-center"},d=(0,n.createElementVNode)("label",{for:"beg",class:"font-semibold"},"Початок",-1),v={class:"flex flex-col justify-center"},f=(0,n.createElementVNode)("label",{for:"end",class:"font-semibold"},"Кінець",-1),m={class:"w-full flex flex-col flex-wrap justify-center items-between px-4 py-4 gap-2"},p={class:"w-full flex flex-wrap justify-start items-start gap-6"},x={class:"w-full flex flex-wrap justify-start items-start gap-6"},h={class:"w-full flex flex-wrap justify-start items-start gap-6"},g={class:"w-full flex flex-wrap justify-start items-start gap-6"},y=(0,n.createElementVNode)("div",{class:"w-full flex justify-center items-center mt-8"},[(0,n.createElementVNode)("h1",{class:"text-center text-3xl text-gray-500 font-light"},"Меню")],-1),w={style:{"flex-basis":"25%","max-width":"30%"}},b={class:"text-lg text-gray-500 font-normal"};var V={class:"flex justify-start items-center"},N={class:"text-xl font-semibold"};var k={class:"flex flex-col p-5"},E={class:"text-lg text-gray-500 font-normal"},B={class:"w-full flex justify-start items-start"},S=(0,n.createElementVNode)("div",{class:"w-full bg-gray-300 mr-2",style:{height:"1px"}},null,-1),j={key:0,class:"text-xs text-gray-400 font-normal pr-4"};const D={name:"Block",props:{title:{type:String},description:{type:String,default:"This is a value block's description."}},data:function(){return{metrics:null}}};var F=l(744);const O={name:"ValueBlock",components:{Block:(0,F.Z)(D,[["render",function(e,t,l,a,i,o){var r,s;return(0,n.openBlock)(),(0,n.createElementBlock)("div",k,[(0,n.createElementVNode)("h1",E,(0,n.toDisplayString)(null!==(r=l.title)&&void 0!==r?r:""),1),(0,n.createElementVNode)("div",B,[(0,n.renderSlot)(e.$slots,"default")]),S,(null===(s=l.description)||void 0===s?void 0:s.length)>0?((0,n.openBlock)(),(0,n.createElementBlock)("p",j,(0,n.toDisplayString)(l.description),1)):(0,n.createCommentVNode)("",!0)])}]])},props:{value:{},title:{type:String},description:{type:String,default:null}}},_={components:{ValueBlock:(0,F.Z)(O,[["render",function(e,t,l,a,i,o){var r=(0,n.resolveComponent)("Block");return(0,n.openBlock)(),(0,n.createBlock)(r,{title:l.title,description:l.description},{default:(0,n.withCtx)((function(){var e;return[(0,n.createElementVNode)("div",V,[(0,n.createElementVNode)("span",N,(0,n.toDisplayString)(null!==(e=l.value)&&void 0!==e?e:"--"),1)])]})),_:1},8,["title","description"])}]])},props:["card"],data:function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e.getFullYear(),e.getMonth()+1,0);return{id:null,beg:this.formatDate(t),end:this.formatDate(l),metrics:null,isFetching:!1}},computed:{isSuper:function(){var e;return null===(e=this.card)||void 0===e?void 0:e.isSuper},restaurantId:function(){var e;return null===(e=this.card)||void 0===e?void 0:e.restaurantId},summary:function(){var e,t;return null!==(e=null===(t=this.metrics)||void 0===t?void 0:t.summary)&&void 0!==e?e:null},banquets:function(){var e,t;return null!==(e=null===(t=this.summary)||void 0===t?void 0:t.banquets)&&void 0!==e?e:{amount:null}},guests:function(){var e,t;return null!==(e=null===(t=this.summary)||void 0===t?void 0:t.guests)&&void 0!==e?e:{adults:null,children:null,total:null}},totals:function(){var e,t;return null!==(e=null===(t=this.summary)||void 0===t?void 0:t.totals)&&void 0!==e?e:{total:null,actual_total:null,tickets_total:null,metrics:{difference:null,percentage:null}}},sales:function(){var e,t;return null!==(e=null===(t=this.summary)||void 0===t?void 0:t.sales)&&void 0!==e?e:{menus:null,products:null}},menuSales:function(){var e,t;return null!==(e=null===(t=this.sales)||void 0===t?void 0:t.menus)&&void 0!==e?e:null},productSales:function(){var e,t;return null!==(e=null===(t=this.sales)||void 0===t?void 0:t.products)&&void 0!==e?e:null}},methods:{formatDate:function(e){var t=new Date(e),l=""+(t.getMonth()+1),n=""+t.getDate(),a=t.getFullYear();return l.length<2&&(l="0"+l),n.length<2&&(n="0"+n),[a,l,n].join("-")},splitOnChunks:function(e,t){for(var l=[],n=0;n<e.length;n+=t)l.push(e.slice(n,n+t));return l},fetchMetrics:function(e){var t,l,n=this,a="?restaurant_id=".concat(e);null!==(t=this.beg)&&void 0!==t&&t.length&&(a+="&beg=".concat(this.beg)),null!==(l=this.end)&&void 0!==l&&l.length&&(a+="&end=".concat(this.end)),this.metrics=null,this.isFetching=!0,Nova.request().get("/nova-vendor/metrics-card/full"+a).then((function(e){n.metrics=e.data,n.isFetching=!1})).catch((function(e){console.error(e),n.isFetching=!1}))},onFetch:function(){var e;if(!this.isFetching){var t=this.isSuper&&null!==(e=this.id)&&void 0!==e?e:this.restaurantId;t&&this.fetchMetrics(t)}}},mounted:function(){this.onFetch()}},C=(0,F.Z)(_,[["render",function(e,t,l,V,N,k){var E=(0,n.resolveComponent)("ValueBlock"),B=(0,n.resolveComponent)("card",!0);return(0,n.openBlock)(),(0,n.createBlock)(B,{class:"container h-auto w-full flex flex-col"},{default:(0,n.withCtx)((function(){var e,l,V,B,S,j,D,F,O,_,C,M,q,I,T,Z;return[(0,n.createElementVNode)("div",a,[i,(0,n.createElementVNode)("button",{class:"flex-shrink-0 shadow rounded focus:outline-none ring-primary-200 dark:ring-gray-600 focus:ring bg-primary-500 hover:bg-primary-400 active:bg-primary-600 text-white dark:text-gray-800 inline-flex items-center font-bold px-4 h-9 text-sm flex-shrink-0",disabled:N.isFetching,onClick:t[0]||(t[0]=function(){return k.onFetch&&k.onFetch.apply(k,arguments)})},(0,n.toDisplayString)(N.isFetching?"Завантаження...":"Завантажити"),9,o)]),(0,n.createElementVNode)("div",r,[k.isSuper?((0,n.openBlock)(),(0,n.createElementBlock)("div",s,[u,(0,n.withDirectives)((0,n.createElementVNode)("input",{name:"id",type:"number",class:"bg-transparent","onUpdate:modelValue":t[1]||(t[1]=function(e){return N.id=e})},null,512),[[n.vModelText,N.id]])])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",c,[d,(0,n.withDirectives)((0,n.createElementVNode)("input",{name:"beg",type:"date",class:"bg-transparent","onUpdate:modelValue":t[2]||(t[2]=function(e){return N.beg=e})},null,512),[[n.vModelText,N.beg]])]),(0,n.createElementVNode)("div",v,[f,(0,n.withDirectives)((0,n.createElementVNode)("input",{name:"end",type:"date",class:"bg-transparent","onUpdate:modelValue":t[3]||(t[3]=function(e){return N.end=e})},null,512),[[n.vModelText,N.end]])])]),(0,n.createElementVNode)("div",m,[(0,n.createElementVNode)("div",p,[(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(e=k.banquets.amount)&&void 0!==e?e:null,title:"Банкети",description:"Кількість банкетів у станах: новий, підтверджений та завершений"},null,8,["value"])]),(0,n.createElementVNode)("div",x,[(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(l=k.guests.total)&&void 0!==l?l:null,title:"Гості",description:"Кількість гостів (діти + дорослі)"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(V=k.guests.adults)&&void 0!==V?V:null,title:"Дорослі",description:"Кількість дорослих"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(B=k.guests.children)&&void 0!==B?B:null,title:"Діти",description:"Кількість дітей"},null,8,["value"])]),(0,n.createElementVNode)("div",h,[(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(S=k.totals.total)&&void 0!==S?S:null,title:"Вартість",description:"Загальна вартість усіх банкетів (розрахована по замовленим у системі позиціям + вартість квитків)"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(j=k.totals.actual_total)&&void 0!==j?j:null,title:"Фактична вартість",description:"Загальна фактична вартість усіх банкетів (введена вручну працівниками закладу, при відсутності цього значення використовується вартість)"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(D=k.totals.tickets_total)&&void 0!==D?D:null,title:"Вартість квитків",description:"Загальна вартість квитків усіх банкетів"},null,8,["value"])]),(0,n.createElementVNode)("div",g,[(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(F=null===(O=k.totals)||void 0===O||null===(O=O.metrics)||void 0===O?void 0:O.difference)&&void 0!==F?F:null,title:"Різниця вартостей",description:"Різниця вартостей = Фактична Вартість - Вартість"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(_=null===(C=k.totals)||void 0===C||null===(C=C.metrics)||void 0===C?void 0:C.percentage)&&void 0!==_?_:null,title:"Відсоткова різниця",description:"Відсоткова різниця = Різниця вартостей / Вартість"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(M=k.totals)&&void 0!==M&&M.actual_total&&null!==(q=k.banquets)&&void 0!==q&&q.amount?Math.round(100*((null===(I=k.totals)||void 0===I?void 0:I.actual_total)/(null===(T=k.banquets)||void 0===T?void 0:T.amount)+Number.EPSILON))/100:null,title:"Середня вартість",description:"Середня вартість = Фактична вартість / Банкети"},null,8,["value"])]),null!==(Z=k.menuSales)&&void 0!==Z&&Z.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[y,((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(k.menuSales,(function(e){var t,l,a;return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"w-full flex flex-wrap justify-start items-start gap-6",key:null==e?void 0:e.id},[(0,n.createElementVNode)("div",w,[(0,n.createElementVNode)("span",b,(0,n.toDisplayString)(null!==(t=null==e?void 0:e.title)&&void 0!==t?t:null),1)]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(l=null==e?void 0:e.amount)&&void 0!==l?l:null,title:"Продажі"},null,8,["value"]),(0,n.createVNode)(E,{class:"flex-grow",style:{"flex-basis":"25%","max-width":"30%"},value:null!==(a=null==e?void 0:e.total)&&void 0!==a?a:null,title:"На суму"},null,8,["value"])])})),128))],64)):(0,n.createCommentVNode)("",!0)])]})),_:1})}]]);Nova.booting((function(e,t){e.component("metrics-card",C)}))},962:()=>{},744:(e,t)=>{t.Z=(e,t)=>{const l=e.__vccOpts||e;for(const[e,n]of t)l[e]=n;return l}}},l={};function n(e){var a=l[e];if(void 0!==a)return a.exports;var i=l[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,l,a,i)=>{if(!l){var o=1/0;for(c=0;c<e.length;c++){for(var[l,a,i]=e[c],r=!0,s=0;s<l.length;s++)(!1&i||o>=i)&&Object.keys(n.O).every((e=>n.O[e](l[s])))?l.splice(s--,1):(r=!1,i<o&&(o=i));if(r){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[l,a,i]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={440:0,458:0};n.O.j=t=>0===e[t];var t=(t,l)=>{var a,i,[o,r,s]=l,u=0;if(o.some((t=>0!==e[t]))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(s)var c=s(n)}for(t&&t(l);u<o.length;u++)i=o[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},l=self.webpackChunkandriichello_metrics=self.webpackChunkandriichello_metrics||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})(),n.O(void 0,[458],(()=>n(38)));var a=n.O(void 0,[458],(()=>n(962)));a=n.O(a)})();